\chapter{Next Steps and Moving to 2D\label{ch:5_2DGKP}}


In the previous chapter, we presented the results of our experiments with a fluxonium in a 3D cavity. We demonstrated a tunable dispersive shift between the qubit and the storage resonator via bosonic mode threading and characterized the various components of our system. In doing so, we discovered that the lifetime of the storage mode was \textit{significantly} lower than expected (as compared to its bare value) whenever the qubit chip was inserted into the resonator package. After many rounds of experimentation and testing, we were ultimately able to attribute this effect to two main sources: (i) the storage mode's coupling to the lossy qubit flux line; and (ii), its participation in spurious modes of the 3D superconducting package. While the former issue could in principle be solved via clever microwave engineering and filtering, the latter unfortunately is intrinsic to our 3D design and not easily remedied. As we came to learn, it is generally difficult to integrate fast-flux into a 3D cavity while also maintaining the cavity coherence. 

There are certain approaches that have been proposed and implemented in the literature that work towards integrating fast-flux in 3D. One such example is the magnetic hose from Refs. \cite{gargiulo2021fast,valadares2023demand}. Here, the authors route flux from an external coil to a tunable transmon qubit in a 3D superconducting package using a ``hose'' composed of concentric aluminium and mu-metal layers. In the experiment of Ref. \cite{valadares2023demand} specifically, this is done for the purpose of bosonic cQED, and the authors demonstrate that the lifetime of their 3D storage resonator is not limited by their flux delivery mechanism. Unfortunately, however, the design and implementation of a magnetic hose is quite painstaking, and would require a full redesign of both the cavities and the fluxonium chips that were presented in Ch. \ref{ch:4_3DGKP}. Other designs have also been proposed recently, e.g. Ref. \cite{hutin2024monitoring} or Ref. \cite{maiti2024ancilla}, which both rely on some form of on-chip distributed-element microwave filtering to prevent losses from the flux line at the frequency of the storage. Despite requiring more advanced microwave engineering in design, these approach seem promising for integrating fast-flux in 3D while maintaining the storage resonator lifetime. 

In our case, however, after discovering the root cause of our storage coherence issues and identifying various avenues to proceed from there, we decided to forgo the 3D architecture entirely. This was in part due to the time and difficulty of implementing fast-flux delivery in 3D (which, as highlighted above, is a difficult project in of itself); but it was also a choice we made consciously, motivated by the idea of moving our experiments to 2D. Over the course of our 3D-GKP project, we ended up developing an entirely separate but novel way to do GKP error correction in 2D, using a microwave-activated coupler to generate faster conditional displacements. This 2D project, first proposed using a transmon control qubit and later a fluxonium, represents an improvement over the ``direct dispersive'' approach we took in our 3D-GKP project in most ways. As such, we decided that moving to 2D is a more promising long term path towards building extensible GKP error correction systems. 

In this chapter, we present three of our proposals for implementing GKP error correction in 2D. Within our bosonic subgroup in EQuS, we refer to these as the ``RAT'' (see Ch. \ref{sec:5_RAT}), the ``RAF'' (see Ch. \ref{sec:5_RAF}), and the ``2D dispersive'' (see Ch. \ref{sec:5_2D_Disp}) approaches, respectively\footnote{The meaning behind these names will become apparent shortly!}. We will go through the basic theory for all three approaches and discuss high-level results. In particular, we have already completed designs for the RAF and 2D dispersive projects, which are currently being fabricated as of this writing. 

Here, my aim is give a broad overview to our upcoming 2D experiments; however, more details and a discussion of the careful design and simulation considerations taken can be found in the SM thesis of Shantanu Jha. 
\clearpage


\section{The Asymmetrically-Threaded-SQUID Coupler \label{sec:5_RAT}}

The core insight that motivated our investigation into GKP error correction in 2D was that we can use an Asymmetrically-Threaded SQUID (ATS) as a coupler element to realize the desired ``three-wave mixing'' conditional displacement term that underpins all GKP QEC schemes. The ATS is a superconducting dipole element consisting of a symmetric SQUID shunted by an inductor, as shown in Fig. \ref{fig:5_ats_spectrum}(a); the two resulting flux loops in the circuit are then typically biased \textit{asymmetrically} \cite{lescanne2020exponential, berdou2023one}. In practice, the inductor is realized using an array of Josephson junctions and so the circuit itself is similar to that of a gradiometric SNAIL \cite{miano2022frequency}; it was also recently referred to as the Linear Inductive Coupler when biased symmetrically \cite{maiti2024ancilla}. Despite these various names, we will refer to the actual dipole element as an ATS throughout our work, irrespective of its bias point. 

\begin{figure}[h]
    \centering
    \includegraphics[width=\linewidth]{Figures/5/ats_spectrum.pdf}
    \caption{\textbf{(a)} Circuit diagram for the ATS dipole element (shaded in gray) which consists of a symmetric SQUID shunted by an inductor. The left/right loops are threaded by fluxes $\varphi_l$/$\varphi_r$ respectively, giving rise to common and differential fluxes $\varphi_\Sigma$ and $\varphi_\Delta$. When the ATS is connected to a capacitor, it forms a mode. \textbf{(b)} Fundamental frequency of the ATS mode vs. flux $(\varphi_\Sigma, \varphi_\Delta)$ using parameters $E_L/h = 60$ GHz, $E_J/h = 30$ GHz, and $E_C/h = 80$ MHz.}
    \label{fig:5_ats_spectrum}
\end{figure}

\noindent To begin our exploration of the ATS, let's consider its potential energy, which is given by:
\begin{equation}
    \hat{U}_b = \frac{1}{2}E_L \bigg(\hat{\varphi} + \frac{C_r\varphi_r - C_l\varphi_l}{C_\Sigma}\bigg)^2 - E_{J,l}\cos\!\bigg(\hat{\varphi} + \frac{C_r}{C_\Sigma}[\varphi_l + \varphi_r]\bigg) - E_{J,r}\cos\!\bigg(\hat{\varphi} - \frac{C_l}{C_\Sigma}[\varphi_l + \varphi_r]\bigg)
\end{equation}
Here, we have used the method of Ref. \cite{you2019circuit} to write the potential in terms of its irrotational variable $\hat{\varphi}$, which is the correct approach for time-varying external fluxes; the expression is thus somewhat different from the original description of the ATS in Ref. \cite{lescanne2020exponential}. We have left and right junctions with energies $E_{J, l/r}$, inherent capacitances $C_{l/r}$, and external fluxes $\varphi_{l/r}$ respectively. At this point, we can define the effective $E_J = (E_{J,l} + E_{J,r})/2$ and asymmetry $\Delta E_J = (E_{J,l} - E_{J,r})/2$, and transform to sum and difference coordinates $\varphi_{\Sigma/\Delta} = (\varphi_l \pm \varphi_r)/2$.  Ideally, we would like the junctions to be perfectly symmetric; in practice the asymmetry can be minimized to about $1\%$ of $E_J$. While this is important to keep track of, we will here set $\Delta E_J \to 0$ in the rest of the theory that follows. Thus, $E_{J,l} = E_{J,r} = E_J$ and $C_l = C_r = C$, with $C_\Sigma = C_l + C_r$. We can therefore simplify the complicated expression above and write the potential as:
\begin{equation}
\hat{U}_b(\hat{\varphi}) = \frac{1}{2}E_L(\hat{\varphi} - \varphi_\Delta)^2 - 2E_J \cos(\varphi_\Sigma)\cos(\hat{\varphi})
\end{equation}
In what follows, we will typically keep the differential flux $\varphi_\Delta$ constant and only modulate the common flux $\varphi_\Sigma = \varphi_\Sigma(t)$. Therefore, we can perform a gauge transformation to move the now DC flux $\varphi_\Delta$ to the cosine via $\hat{\varphi} \mapsto \hat{\varphi} + \varphi_\Delta$. This finally get us back to the familiar expression
\begin{equation}
\hat{U}_b(\hat{\varphi}) = \frac{1}{2}E_L\hat{\varphi}^2 - 2E_J \cos(\varphi_\Sigma)\cos(\hat{\varphi} + \varphi_\Delta)
\end{equation}
that can be found in Refs. \cite{lescanne2020exponential, berdou2023one}. We will use this throughout the rest of this chapter.

As shown in Fig. \ref{fig:5_ats_spectrum}(b), when the ATS is connected to a capacitance, the resulting mode has a fundamental frequency that is doubly periodic in $\varphi_\Sigma$ and $\varphi_\Delta$, forming an `egg-carton' potential as it is sometimes referred to. There are two typical operating points for the ATS:

\begin{itemize}
    \item \textbf{Asymmetric bias point:} $(\varphi_\Sigma, \varphi_\Delta) = (\pi/2, \pi/2)$, corresponding to $\varphi_l = \pi$ and $\varphi_r = 0$. This is the standard operating point for the ATS. By modulating the sum flux around this bias, i.e. $\varphi_\Sigma(t) = \pi/2 + \epsilon(t)$, we get the following time-dependent potential for the ATS dipole:
    \begin{equation}
        \hat{U}_b(\hat{\varphi}) = \frac{1}{2}E_L \hat{\varphi}^2 - 2E_J \sin[\epsilon(t)]\sin(\hat{\varphi})
    \end{equation}
\item \textbf{Symmetric bias point:} $(\varphi_\Sigma, \varphi_\Delta) = (\pi/2, 0)$, corresponding to $\varphi_l = \varphi_r = \pi/2$. Biasing here gives us:
\begin{equation}
        \hat{U}_b(\hat{\varphi}) = \frac{1}{2}E_L \hat{\varphi}^2 - 2E_J \sin[\epsilon(t)]\cos(\hat{\varphi})
    \end{equation}
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{The Resonator-ATS-Transmon (RAT)}

Our first approach to faster GKP error correction was developed using the ATS as a coupler element between a storage resonator and a transmon control qubit. We name this the RAT. The basic idea relies on black-box quantization (cf. Ch. \ref{ch:3_cQED}) between the three modes $\hat{a}_0$, $\hat{b}_0$, and $\hat{q}_0$ for the resonator, ATS, and transmon respectively. The bare transmon Hamiltonian is:
\begin{equation}
\hat{H}_{q, 0} = 4E_{C,q}\hat{n}_q^2 - E_{J,q}\cos(\hat{\theta}) = \omega_{q,0}\,\hat{q}_0^\dagger \hat{q}_0 - \Big[E_{J,q}\cos(\hat{\theta}) + \frac{1}{2}E_{J,q} \hat{\theta}^2\Big] 
\end{equation}
where we write the mode $\hat{q}_0$ in terms of the transmon charge $\hat{n}_q$ and phase-drop $\hat{\theta}$. For the ATS, it is:
\begin{equation}
\hat{H}_{b,0} = 4E_C \hat{n}^2 + \hat{U}_b(\hat{\varphi}) = \omega_{b,0}\hat{b}_0^\dagger \hat{b}_0 - 2E_J \cos(\varphi_\Sigma)\cos(\hat{\varphi} + \varphi_\Delta)
\end{equation}
in terms of the ATS charge operator $\hat{n}$ and phase-drop $\hat{\varphi}$. Finally, for the storage we have $\hat{H}_{a, 0} = \omega_{a,0}\hat{a}_0^\dagger \hat{a}_0$. If we take the modes to be linearly coupled (e.g. via capacitive coupling) in series, i.e. resonator $\leftrightarrow$ ATS $\leftrightarrow$ transmon, then the total Hamiltonian has a \textit{linear} part:
\begin{equation}
\hat{H}_{\rm lin, 0} = \omega_{a,0}\hat{a}_0^\dagger \hat{a}_0 + \omega_{b,0}\hat{b}_0^\dagger \hat{b}_0 + \omega_{q,0}\hat{q}_0^\dagger \hat{q}_0 - g_{ab}(\hat{a}_0 - \hat{a}_0^\dagger)(\hat{b}_0 - \hat{b}_0^\dagger) - g_{qb}(\hat{b}_0 - \hat{b}_0^\dagger)(\hat{q}_0 - \hat{q}_0^\dagger)
\end{equation}
Following black-box quantization, we can diagonalize $\hat{H}_{\rm lin, 0}$ as a system of normal modes $\hat{a}$ (storage-like), $\hat{b}$ (buffer-like), and $\hat{q}$ (qubit-like). In this basis $\hat{H}_{\rm lin} = \omega_a \hat{a}^\dagger\hat{a} + \omega_b \hat{b}^\dagger\hat{b} + \omega_q \hat{q}^\dagger\hat{q}$, where $\omega_a$, $\omega_b$, and $\omega_q$ are the normal mode frequencies. We can also rewrite the bare modes in this normal mode basis via a linear transformation:
\begin{align}
\hat{\theta} &= \theta_{q, 0}(\hat{q}_0 + \hat{q}_0^\dagger) = \theta_q(\hat{q} + \hat{q}^\dagger) + \theta_b(\hat{b} + \hat{b}^\dagger) + \theta_a(\hat{a} + \hat{a}^\dagger) \\
\hat{\varphi} &= \phi_{b, 0}(\hat{b}_0 + \hat{b}_0^\dagger) = \phi_q(\hat{q} + \hat{q}^\dagger) + \phi_b(\hat{b} + \hat{b}^\dagger) + \phi_a(\hat{a} + \hat{a}^\dagger)
\label{eq:linear_basis_RAT_RAF}
\end{align}
Here, $\theta_i$ denotes the participation of mode $i$ in the phase across the Josephson junction in the transmon, while $\phi_i$ is the participation in the phase across the ATS. In total, we have
\begin{equation}
\hat{H} = \sum_{c = \{a, b, q\}}\omega_c \hat{c}^\dagger\hat{c} - \Big[E_{J,q}\cos(\hat{\theta}) + \frac{1}{2}E_{J,q} \hat{\theta}^2\Big] - 2E_J \cos(\varphi_\Sigma)\cos(\hat{\varphi} + \varphi_\Delta)
\end{equation}
as the Hamiltonian for the full resonator-ATS-transmon system written in the ``black-box quantization'' basis (i.e. of the normal modes of the linearized circuit). 

With the Hamiltonian written down, let's now see how to get conditional displacements out of it. We park the ATS at its standard asymmetric bias point $(\varphi_\Sigma, \varphi_\Delta) = (\pi/2, \pi/2)$ and modulate $\varphi_\Sigma(t) = \pi/2 + \epsilon(t)$ about this. The ATS potential takes on the form $\sin[\epsilon(t)]\sin(\hat{\varphi})$, and so we can Taylor expand $\sin[\epsilon(t)] \approx \epsilon(t)$ and $\sin(\hat{\varphi}) \approx \hat{\varphi} - \hat{\varphi}^3/6$ in anticipation of making a rotating-wave approximation. We can also truncate the transmon potential to a Duffing oscillator, considering only the leading fourth-order nonlinearity. These approximations give us
\begin{equation}
\hat{H} = \sum_{c = \{a, b, q\}}\omega_c \hat{c}^\dagger\hat{c} - \frac{E_{J,q}}{24}\hat{\theta}^4 - 2E_J \epsilon(t)\hat{\varphi} + \frac{1}{3}E_J\epsilon(t)\hat{\varphi}^3
\end{equation}
We go into a rotating frame for each of the modes $\hat{c} \mapsto \hat{c} e^{-i\tilde{\omega}_c t}$ where we set the frequency $\widetilde{\omega}_c = \omega_c - \theta_{c}^{2} \big[\theta_{a}^{2} + \theta_{b}^{2} + \theta_{q}^{2}\big]/2$ to cancel out the frequency normalizations that arise from the transmon nonlinearity. In this frame, we get
\begin{align}
\begin{split}
\hat{H} &= \hat{H}_{cc} - \frac{E_{J,q}}{24}\Big[\theta_q(\hat{q}e^{-i\tilde{\omega}_q t} + \hat{q}^\dagger e^{i\tilde{\omega}_q t}) + \theta_b(\hat{b}e^{-i\tilde{\omega}_b t} + \hat{b}^\dagger e^{i\tilde{\omega}_b t}) + \theta_a(\hat{a}e^{-i\tilde{\omega}_a t} + \hat{a}^\dagger e^{i\tilde{\omega}_a t})\Big]^4 \\&\quad- 2E_J\epsilon(t)\Big[\phi_q(\hat{q}e^{-i\tilde{\omega}_q t} + \hat{q}^\dagger e^{i\tilde{\omega}_q t}) + \phi_b(\hat{b}e^{-i\tilde{\omega}_b t} + \hat{b}^\dagger e^{i\tilde{\omega}_b t}) + \phi_a(\hat{a}e^{-i\tilde{\omega}_a t} + \hat{a}^\dagger e^{i\tilde{\omega}_a t})\Big]\\ &\quad + \frac{1}{3}E_J\epsilon(t)\Big[\phi_q(\hat{q}e^{-i\tilde{\omega}_q t} + \hat{q}^\dagger e^{i\tilde{\omega}_q t}) + \phi_b(\hat{b}e^{-i\tilde{\omega}_b t} + \hat{b}^\dagger e^{i\tilde{\omega}_b t}) + \phi_a(\hat{a}e^{-i\tilde{\omega}_a t} + \hat{a}^\dagger e^{i\tilde{\omega}_a t})\Big]^3
\end{split}
\end{align}
where $\hat{H}_{cc} = \sum (\omega_c - \tilde{\omega}_c)\hat{c}^\dagger\hat{c}$ will cancel out when the terms are expanded. At this point our task involves sorting through the various pumped nonlinear terms and keeping only the ones that survive the RWA. We set $\epsilon(t) = \epsilon_p \sin(\omega_p t)$ with $\omega_p = \tilde{\omega}_a$, picking out terms that rotate at the (renormalized) storage frequency. Luckily we can do the oscillator expansion, normal ordering, and RWA all numerically using SymPy. The final effective Hamiltonian
\begin{align}
\begin{split}
\hat{H}_{\rm eff} &= \frac{K_a}{2}{{a}^\dagger}^{2} {a}^{2} + \frac{K_b}{2}{{b}^\dagger}^{2} {b}^{2} + \frac{K_q}{2}{{q}^\dagger}^{2} {q}^{2} + \frac{\chi_{ab}}{2}\hat{a}^\dagger\hat{a}\hat{b}^\dagger\hat{b} + \frac{\chi_{aq}}{2} \hat{a}^\dagger\hat{a}\hat{q}^\dagger\hat{q} + \frac{\chi_{qb}}{2} \hat{q}^\dagger\hat{q}\hat{b}^\dagger\hat{b} \\
&\quad + g_{\rm CD}{{q}^\dagger} {q}\big(\hat{a} + \hat{a}^\dagger\big) + g_{\rm disp} \big(\hat{a}+\hat{a}^\dagger\big) + g_a\big[{{a}^\dagger} {a}^{2} + {{a}^\dagger}^{2} {a}\big] + g_b {{b}^\dagger} {b}\big(\hat{a} + \hat{a}^\dagger\big) 
\end{split}
\end{align}
has many terms that we can categorize as follows. We have Kerr nonlinearities for all three modes $K_x = -E_{J, q}\theta_{x}^{4} / 2$ and cross-Kerr dispersive shifts $\chi_{xy} = -2E_{J, q}\theta_{x}^{2} \theta_{y}^{2}$. Next, we have the desired conditional displacement $g_{\rm CD} = E_J\epsilon_{p} \phi_{a} \phi_{q}^{2}$ and an unconditional displacement $g_{\rm disp} = E_J\epsilon_p\big[\phi_a^3 +\phi_{a} \phi_{q}^{2} + \phi_{a} \phi_{b}^{2} - 2\phi_a\big]/2$. Finally, we also have two spurious nonlinear terms associated with the storage and ATS mode: $g_a = E_J\epsilon_{p} \phi_{a}^{3}/2$ and $g_b = E_J\epsilon_{p} \phi_{a}\phi_{b}^{2}$. The qubit anharmonicity $K_q$ should not affect the oscillator dynamics, and just provides the requisite nonlinearity for control. Furthermore, if the ATS is never strongly populated $\ev{\hat{b}^\dagger\hat{b}} \approx 0$, we can further simplify to just:
\begin{equation}
\hat{H}_{\rm eff} = \frac{\chi_{aq}}{2} \hat{a}^\dagger\hat{a}\hat{q}^\dagger\hat{q} + \frac{K_a}{2}{{a}^\dagger}^{2} {a}^{2} + g_{\rm CD}{{q}^\dagger} {q}\big(\hat{a} + \hat{a}^\dagger\big) + g_{\rm disp} \big(\hat{a}+\hat{a}^\dagger\big) + g_a\big[{{a}^\dagger} {a}^{2} + {{a}^\dagger}^{2} {a}\big]
\label{eq:5_FCD_full_hamiltonian}
\end{equation}
Overall, we have the desired conditional displacement term, along with several additional unwanted terms that we will now discuss how to cancel out. Note that all drive-activated terms are proportional to the flux pump envelope $\epsilon_p = \epsilon_p(t)$, which we can pulse to activate the desired interactions. 

\subsection{Conditional Displacements with the RAT}

It turns out that we can cancel many of the unwanted terms above using an echo protocol reminiscent of the echoed conditional displacement (ECD) from Ref. \cite{eickbusch2022fast} that we reviewed in Ch. \ref{ch:2_QEC}. To see how, let's consider a simplified version of Eq. \eqref{eq:5_FCD_full_hamiltonian} with just the CD term and the dispersive shift. We also truncate the transmon to a two-level qubit $\hat{q}^\dagger\hat{q} \to \hat{\sigma}_z$ and thus have:
\begin{equation}
\hat{H}(t) = \frac{\chi}{2}\hat{a}^\dagger\hat{a}[z(t)\hat{\sigma}_z]   + \Big[g_{\rm CD}(t)\hat{a}^\dagger + g_{\rm CD}^\ast(t)\hat{a}\Big]z(t)\hat{\sigma}_z
\label{eq:5_FCD_simplified_hamiltonian}
\end{equation}
Here we have included a fictitious qubit state parameter $z(t) = \ev{\sigma_z(t)}$ that tells us when to perform $\pi$-pulses \cite{eickbusch2022fast}, and also explicitly highlight the time-dependence $g_{\rm CD}(t)$ controlled via the flux pump. We can then solve the Schr\"odinger equation $i\partial_t\hat{U} = \hat{H}(t)\hat{U}$ in terms of a parameterized ansatz $\hat{U}(t)$. We find the same ansatz and solution as Ref. \cite{eickbusch2022fast}: 
\begin{equation}
    \hat{U}(t) = \exp(i\theta \hat{\sigma}_z / 2)\,\exp\!\Big[\hat{a}^\dagger(\gamma + \delta \hat{\sigma}_z) - \hat{a}(\gamma^\ast + \delta^\ast \hat{\sigma}_z)\Big]\exp(i\phi\hat{a}^\dagger\hat{a}\hat{\sigma}_z)
\end{equation}
where $\theta(t), \gamma(t), \delta(t), \phi(t)$ correspond to a qubit rotation, cavity displacement and conditional displacement, and a qubit-selective cavity rotation. Plugging in Eq. \eqref{eq:5_FCD_simplified_hamiltonian} and solving the Schr\"odinger equation, it turns out we can actually find a solution:
\begin{align}
    \begin{split}
        \theta(t) & = +2 \int_0^t d\tau \mathrm{Re}[g_{\rm CD}^*(\tau)\gamma(\tau)] \qquad \qquad\delta(t) = -i \int_0^t d\tau \cos[\phi(\tau)-\phi(t)] g_{\rm CD}(\tau)z(\tau) \\\gamma(t) & = - \int_0^t d\tau \sin[\phi(\tau)-\phi(t)] g_{\rm CD}(\tau)z(\tau) \qquad \qquad\phi(t) = -\frac{\chi}{2} \int_0^t d\tau z(\tau)
    \end{split}
\end{align}
If the CD gate has length $T$, we want $\phi(T) = 0$ at the end of the gate, and thus $\int z(\tau)d\tau = 0$, i.e. the area under the curve of $z(t)$ must be net zero. This implies that the qubit state $z(t)$ has to flip signs at least once! Furthermore, as with the ECD protocol, if we consider only $\pi$-pulses on the qubit, then $z \in \{1, -1\}$. These requirements constrain the pulse schedule $z(t)$ to take on the form of a Walsh function \cite{chalermpusitarak2021frame}. To cancel the \textit{unconditional} displacement and keep just a \textit{conditional} displacement, we next want to set
\begin{equation*}
    \gamma(T) = - \int_0^T \!d\tau \sin[\phi(\tau)] g_{\rm CD}(\tau)z(\tau) = 0, \,\,\text{and}\,\, \delta(T) = -i \int_0^T \!d\tau \cos[\phi(\tau)] g_{\rm CD}(\tau)z(\tau) \neq 0.
\end{equation*}
At this point, observe that if $g_{\rm CD}(t)z(t)$ can be made constant over the gate length $T$, then the symmetries of sine and cosine will automatically ensure $\gamma(T) = 0$ and $\delta(T) \neq 0$. Since the $\pi$-pulse schedule $z(t)$ is constained in its form, we can try several ansatze and modulate $g_{\rm CD}(t)$ with the same time-dependence so that $z(t)g_{\rm CD}(t)$ is constant. We find that a double-echo schedule satisfies all of our requirements, with $\pi$-pulses at $t = T/4$ and $t = 3T/4$, and $z(0)=1$ to initialize the qubit in the ground state $\ket{g}$. An example is plotted below, along with the final pulse sequence for $g_{\rm CD}(t)$ [which, again, is set by modulating the flux pump amplitude $\epsilon_p(t)$]. We named this novel sequence the \textbf{f}ast echoed \textbf{c}onditional \textbf{d}isplacement, or FCD, to contrast it from the usual ``single-echo'' ECD that we saw in Ch. \ref{ch:2_QEC}. 

\begin{figure}[t]
    \centering
    \includegraphics[width=\linewidth]{Figures/5/double_echo_FCD.pdf}
    \caption{FCD pulse implementation using the double-echo $\pi$-pulse schedule $z(t)$. Top row: numerical example of $z(t)$, $\sin[\phi(t)]$, and $\cos[\phi(t)]$ for $T = 2$ and $\chi = 4$. Observe $z(t)$ has an integral of zero as required. By modulating $g_{\rm CD}(t)$ to match the time-dependence of $z(t)$, we get constant $g_{\rm CD}(t)z(t) = 1$. The areas under $\sin[\phi(t)]$ and $\cos[\phi(t)]$ then give the relative magnitudes of the unconditional and conditional displacement rates in the FCD unitary. Bottom row: full ideal FCD pulse sequence showing the $\pi$-pulses and $g_{\rm CD}(t)$.}
    \label{fig:5_double_echo_FCD}
\end{figure}

We performed numerical simulations of the FCD gate using a two-level qubit truncated version of the full Hamiltonian in Eq. \eqref{eq:5_FCD_full_hamiltonian}, and found that the double $\pi$-pulse sequence we constructed indeed allows us to echo away the unwanted terms (such as the dispersive term $\chi_{aq}$, the displacement $g_{\rm disp}$, and the nonlinear displacement $g_a$). Unfortunately, however, we also find that the strength of the unconditional displacement $g_{\rm disp}$ in this scheme can be much larger than the conditional displacement $g_{\rm CD}$; using realistic device parameters we found that $g_{\rm disp}$ is often an order of magnitude larger. As a result, we expect that a separate ``cancellation drive'' on the storage will be required if we want to implement the FCD scheme in practice. 

Beyond this, we also found that the various design constraints for a realistic RAT device can be quite demanding, as it is somewhat difficult to hit the various couplings and mode capacitances during design/simulation. Moreover, the transmon control qubit in the RAT approach would still be susceptible to frequent bit-flip errors, limiting the GKP code performance. For these reasons, we chose to develop an alternative to the RAT with a fluxonium control qubit in place of the transmon; we will discuss this next. 

Despite the challenges associated with it, the RAT remains a novel and interesting theoretical proposal for implementing GKP error correction, and we hope the ideas behind it may be useful in developing further experiments in the future. 
 \clearpage
 %%%%%%%%%%%%%%%%%%%%%%%%

\section{The Resonator-ATS-Fluxonium (RAF) Experiment \label{sec:5_RAF}}

Our current main approach to realizing GKP error correction in 2D is called the RAF. It builds upon the idea of using an ATS as a coupler to realize fast conditional displacements, but instead uses a heavy fluxonium control qubit. To understand the principle behind the RAF, we start from the Hamiltonian for a coupled a storage resonator, ATS, and fluxonium system: $\hat{H} = \hat{H}_a + \hat{H}_b + \hat{H}_q + \hat{H}_{\rm int}$, where $\hat{H}_{\rm int}$ is a linear capacitive coupling term and $\hat{H}_q$ is:
\begin{equation}
    \hat{H}_q = 4E_C \hat{n}_q^2 + \frac{1}{2}\hat{\theta}^2 - E_J\cos(\hat{\theta}-\theta{\rm ext}) = \omega_{q, 0} \hat{q}_0^\dagger\hat{q}_0 - E_J\cos(\hat{\theta}-\theta{\rm ext})
\end{equation}
Here we have written the fluxonium Hamiltonian in its ``LC basis'' (i.e. the Fock basis for the linear part of the circuit). Following our approach in Sec. \ref{sec:5_RAT}, we can now analyze the full coupled system using a normal mode basis, i.e. absorbing the linear coupling term to get three normal modes $\hat{a}$, $\hat{b}$, and $\hat{q}$ for the storage, ATS, and qubit respectively. In this basis, 
\begin{equation}
    \hat{H} = \sum_{c = \{a, b, q\}}\omega_c \hat{c}^\dagger \hat{c} - E_{J,q}\cos(\hat{\theta}-\theta_\mathrm{ext}) - 2E_J \cos(\varphi_\Sigma)\cos(\hat{\varphi} + \varphi_\Delta)
    \label{eq:RAF_H}
\end{equation}
where the phase operators $\hat{\theta}$ and $\hat{\varphi}$ for the fluxonium and ATS may be expressed as linear combinations of $\hat{a}, \hat{a}^\dagger$, $\hat{b}, \hat{b}^\dagger$, and $\hat{q}, \hat{q}^\dagger$ as in Eq. \eqref{eq:linear_basis_RAT_RAF}, in terms of the participations $\theta_a, \theta_b, \theta_q$ ($\phi_a, \phi_b, \phi_q$) of the the various modes in the fluxonium (ATS) phase. This basis is reminiscent of black-box quantization, but we stress here that no approximation has been made --- as long as we do not truncate the fluxonium, Eq. \eqref{eq:RAF_H} is exact. 

To implement conditional displacements with the RAF, we bias the ATS at the \textit{symmetric} bias point $(\varphi_\Sigma, \varphi_\Delta) = (\pi/2, 0)$ and modulate about this via $\varphi_\Sigma(t) = \pi/2 + \epsilon(t)$. In this case, we get
\begin{equation}
    \hat{H} = \sum_{c = \{a, b, q\}}\omega_c \hat{c}^\dagger \hat{c} - E_{J,q}\cos(\hat{\theta}-\theta_\mathrm{ext}) - 2E_J \sin[\epsilon(t)]\cos\hat{\varphi}
    \label{eq:RAF_H_biaspoint}
\end{equation}
The fluxonium nonlinear term will now give rise to dispersive shifts $\chi_{xy}$ between the three modes, as well as Kerr nonlinearities $K_x$ for $x, y \in \{a, b, q\}$, while the ATS nonlinear term will give us the desired microwave-activated conditional displacement interaction. Let's now focus on the latter term. We can write $\hat{\varphi} = \hat{\varphi}_a + \hat{\varphi}_b + \hat{\varphi}_q$ and Taylor expand the drive $\sin[\epsilon(t)] \approx \epsilon(t) = \epsilon_p\cos(\omega_p t)$. Doing so, we can express this part of the Hamiltonian $\hat{H}_{\rm CD}$ as follows:
\begin{equation}
    \hat{H}_{\rm CD} = - 2E_J\epsilon(t)\big[\cos\hat{\varphi}_q\cos{(\hat{\varphi}_a + \hat{\varphi}_b)} - \sin\hat{\varphi}_q\sin{(\hat{\varphi}_a + \hat{\varphi}_b)}\big]
    \label{eq:RAF_HCD_expanded}
\end{equation}
Here, we have used a trigonometric identity to separate out the qubit ($\hat{\varphi}_q$) terms from the others, for the following reason. The storage $\hat{\varphi}_a = \varphi_a(\hat{a} + \hat{a}^\dagger)$ and ATS $\hat{\varphi}_b= \varphi_b(\hat{b} + \hat{b}^\dagger)$ both have small phase fluctuations, which will allow us to Taylor expand using $\varphi_a, \varphi_b$ as small parameters. Meanwhile, the fluxonium \textit{cannot} be expanded in this manner, and thus we must keep the full nonlinearities $\sin(\hat{\varphi}_q)$ and $\cos(\hat{\varphi}_q)$. Keeping this in mind, we can expand to 
\begin{equation*}
    \cos{(\hat{\varphi}_a + \hat{\varphi}_b)} = \cos\hat{\varphi}_a\cos \hat{\varphi}_b - \sin\hat{\varphi}_a\sin \hat{\varphi}_b \approx \bigg[1 - \frac{\hat{\varphi}_a^2}{2}\bigg]\bigg[1 - \frac{\hat{\varphi}_b^2}{2}\bigg] - \hat{\varphi}_a\hat{\varphi}_b
\end{equation*}
and 
\begin{equation*}
    \sin{(\hat{\varphi}_a + \hat{\varphi}_b)} = \sin\hat{\varphi}_a\cos \hat{\varphi}_b + \cos\hat{\varphi}_a\sin \hat{\varphi}_b \approx \hat{\varphi}_a\bigg[1 - \frac{\hat{\varphi}_b^2}{2}\bigg] + \hat{\varphi}_b\bigg[1 - \frac{\hat{\varphi}_a^2}{2}\bigg]
\end{equation*}
If we now go into the rotating frames of modes $a$ and $b$, and further set the ATS flux drive frequency to the storage frequency $\omega_p = \omega_a$, then we can perform an RWA on Eq. \eqref{eq:RAF_HCD_expanded} to get an effective
\begin{equation}
    \hat{H}_{\rm CD} = 2E_J \bigg[1 - \frac{\varphi_b^2}{2} - \varphi_b^2\hat{b}^\dagger\hat{b}\bigg]\bigg(\frac{\epsilon_p}{2}\bigg)\hat{\varphi_a}\sin(\hat{\varphi}_q)
\end{equation}
Finally, assuming that the ATS mode is never populated due to its detuning from the other modes, we set $\ev{\hat{b}^\dagger\hat{b}} \approx 0$ and can then expand $\hat{\varphi}_a = \varphi_a(\hat{a} + \hat{a}^\dagger)$ to get a final effective Hamiltonian
\begin{equation}
    \hat{H}_{\rm CD} = E_J  \epsilon_p\varphi_a \bigg[1 - \frac{\varphi_b^2}{2} \bigg](\hat{a} + \hat{a}^\dagger)\sin\hat{\varphi}_q \triangleq \hat{H}_{\rm CD}^{(q)} (\hat{a} + \hat{a}^\dagger)
\end{equation}
where we group the prefactors and qubit terms into $\hat{H}_{\rm CD}^{(q)}$. From here, we can calculate the displacement and conditional displacement rates via the sum and difference matrix elements of the qubit part:
\begin{align}
    \begin{split}
        g_\mathrm{disp} &= \frac{1}{2}\Big[\langle g|\hat{H}_{\rm CD}^{(q)}|g\rangle + \langle e|\hat{H}_{\rm CD}^{(q)}|e\rangle \Big] = A\bigg[\langle g|\sin\hat{\varphi}_q|g\rangle + \langle e|\sin\hat{\varphi}_q|e\rangle\bigg] \\
        g_{\rm CD} &= \frac{1}{2}\Big[\langle g|\hat{H}_{\rm CD}^{(q)}|g\rangle - \langle e|\hat{H}_{\rm CD}^{(q)}|e\rangle \Big] = A\bigg[\langle g|\sin\hat{\varphi}_q|g\rangle - \langle e|\sin\hat{\varphi}_q|e\rangle\bigg]
    \end{split}
\end{align}
with a common scale factor $A = \frac{1}{2}E_J\epsilon_p   \varphi_a[1 - \varphi_b^2/2]$. If we truncate the qubit to a two-level subspace, we get
\begin{equation}
    \hat{H}_{\rm CD}^{\rm tls} = g_{\rm disp} (\hat{a}+\hat{a}^\dagger) + g_{\rm CD} (\hat{a}+\hat{a}^\dagger)\hat{\sigma}_z
\end{equation}
This is precisely the conditional displacement interaction we wanted, though it also comes with an additional direct displacement. It so happens, however, that for a heavy-fluxonium away from half-flux, the difference in matrix elements (i.e. $g_{\rm CD}$) can be quite large, while the sum (i.e. $g_{\rm disp}$) can be made quite small; nonetheless, we envision using a cancellation drive to null out the displacement. 

In practice, starting from Eq. \eqref{eq:RAF_H_biaspoint}, we diagonalize the qubit Hamiltonian numerically to compute \textit{all} metrics of interest, such as dispersive shifts and Kerr nonlinearities, in terms of the relevant fluxonium matrix elements. Going from this theoretical proposal to a fully realized experiment took many rounds of design, simulation, and refinement of the theory before we arrived at a final parameter set for the system that satisfied all of the experimental design constraints. I will not discuss these details here; for a more complete treatment, I direct readers to the SM thesis of my colleague Shantanu Jha. 

Instead, I will here just briefly summarize the main results. For our final choice of system parameters, we are able to achieve a large conditional displacement rate $g_{\rm CD}/2\pi \simeq 4$ MHz over a wide range of qubit external flux bias points as shown in Fig. \ref{fig:5_RAF_Metrics}. Over this range, the dispersive shift $\chi_{aq}$ between the fluxonium and storage remains small, and so we don't expect to be limited by oscillator dephasing during qubit reset (which, as we recall from Ch. \ref{ch:4_3DGKP}, was an important consideration in our 3D dispersive experiment and the reason we engineered a flux-tunable dispersive shift to cross through zero there). Lastly, the Kerr nonlinearities $K_g$ and $K_e$ inherited by the storage resonator are neglible (mHz-level). With these values, we expect to be able to achieve state-of-the-art GKP QEC performance. In Fig. \ref{fig:5_RAF_Final_Design}, I also show a false-color image of the final design for the RAF, which is being fabricated as of this writing. In addition the core storage, ATS, and fluxonium subsystem, we have also incorporated a readout resonator and Purcell filter to be able to achieve faster unconditional qubit reset in approximately 100 ns via fluxonium sideband cooling. With this, we expect to be able to perform a cycle of SBS error correction within $\delta t = 400$ ns. 

\begin{figure}[h]
    \centering
    \includegraphics[width=0.95\linewidth]{Figures/5/RAF_Metrics.pdf}
    \caption{Simulated metrics of interest for the RAF using our final design parameters. We get a CD rate of $g_{\rm CD}/2\pi \simeq 4$ MHz across a wide band of external flux operating points $\theta_{\rm ext}$ for the qubit, as well as low residual dispersive shift $\chi_{aq}$ to the storage ($< 0.5$ kHz) and negligible (mHz-level) Kerr nonlinearity.}
    \label{fig:5_RAF_Metrics}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.7\linewidth]{Figures/5/RAF_Final_Design.pdf}
    \caption{Final chip design for the RAF, consisting of a storage resonator, ATS coupler, and fluxonium control qubit, as well as a readout resonator and Purcell filter for fast reset. For more details, we invite readers to refer to the upcoming SM thesis of Shantanu Jha.}
    \label{fig:5_RAF_Final_Design}
\end{figure}

\clearpage


\section{The 2D Dispersive Experiment: Moving 3D \texorpdfstring{$\to$}{to} 2D\label{sec:5_2D_Disp}}

Our final proposed approach to implement GKP error correction in 2D is our so-called 2D dispersive project. We came up with this approach during the penultimate stage of design for the RAF, which also coincided with our last attempts to fix the storage coherence issues in our 3D dispersive experiment (these issues turned out to be inherent to our 3D package). Given the daunting possibility of having to redesign the 3D experiment from scratch this late into the project, we set out to identify as many alternative paths forward as possible and ultimately settled on the following: why not move the dispersive coupling experiment entirely to 2D, replacing the 3D cavity with an on-chip resonator? This idea was attractive to us for several key reasons: 
\begin{enumerate}
    \item In 2D, the storage and fluxonium can be directly coupled capacitively and we don't need an antenna to mediate the coupling. By reducing one linear mode, this would help alleviate the parasitic Purcell resonances that we saw in  Sec. \ref{sec:4_fluxonium_T1}.
    \item In contrast to 3D, fast-flux control of the qubit can be implemented straightforwardly via on-chip flux lines in 2D. 
    \item Specific to our fabrication workflow in EQuS, a 2D design could be fabricated using a standard 2" wafer at Lincoln Lab as opposed to the 8" wafer that was required for the fluxonium chips we used in our 3D experiment; using the more standard process would help with fabrication time, yield, and parameter targeting. 
    \item We could use the design/simulation infrastructure already developed for the RAF to expedite the process. Indeed, this ultimately proved to be the single most important factor and enabled us to go from ideation to a complete design in under two months. 
    \item It is a simpler 2D experiment than the RAF, and so helps mitigate the risk of failure. 
\end{enumerate}

Of course, as we noted in the previous section, 2D resonators have higher single-photon losses. A 2D dispersive design relying on ECD would not be able to correct such errors as efficiently as the RAF. Nonetheless, given our strategy of using a large gap low-frequency resonator, it seems within the realm of possibility to achieve a storage resonator lifetime of $T_1 \simeq 100$ $\mu$s. As we will see below, this would already be enough to demonstrate QEC. 

\subsection{System Parameters and Design Overview}
The 2D dispersive design consists of four main elements: the storage resonator, fluxonium qubit, readout resonator, and a Purcell filter to help achieve larger resonator linewidth for the SBS reset without causing excess loss to the qubit. As with the RAF, the various design parameters here were chosen to balance many different experimental constraints, and had to be iteratively refined via successive rounds of simulation. The final design is shown in Fig. 5-1, and we will now discuss some of the design considerations that went into it.
\begin{figure}[h] 
    \begin{subfigure}{\linewidth}
        \centering
        \includegraphics[width=0.8\linewidth]{Figures/5/2D_Dispersive_GDS.pdf}
        \vspace*{2mm}
    \end{subfigure} 
    \begin{subfigure}{\linewidth}
        \centering
        \begin{tabular}{c|c|c|c|c|c|c|c|c }
       $\omega_s/2\pi$ & $J_{fs}/2\pi$ & $E_J/h$  & $E_C/h$ & $E_L/h$ & $g_{rq}/2\pi$ & $\omega_r/2\pi$ & $\omega_p/2\pi$ & $g_{pr}/2\pi$\\\hline
        4134.0 & 3.0 & 3754.9 & 844.0 & 299.9 & 42.1 & 6125.0 & 6137.0 & 27.6
    \end{tabular}
    \end{subfigure}
    \caption{Final GDS design and parameters for the 2D dispersive experiment, showing the on-chip storage resonator, fluxonium qubit, readout resonator, and Purcell filter. The frequency parameters for the various elements in the table are all listed in MHz}
    \label{fig:5_2D_Dispersive_GDS}
\end{figure}

\noindent \textbf{Fluxonium:} We chose the nominal qubit parameters $E_J, E_C, E_L$ shown above in Fig. \ref{fig:5_2D_Dispersive_GDS} to achieve a moderately heavy fluxonium with a frequency of $\omega_q/2\pi \simeq 107$ MHz at half-flux. We expect this will result in a long $T_1^{g\to e}$ away from the sweet spot. These parameters also ensured that the qubit plasmon transition frequencies were high enough to not be limited by heating out of the $\ket{g}$-$\ket{e}$ manifold. 


\noindent \textbf{Storage and Fluxonium System:} The storage mode was designed as a large gap (60 $\mu$m) $\lambda/4$ coplanar waveguide resonator with a resulting impedance of $Z_0 = 95.127$ $\Omega$. We chose its frequency to be as low as possible to maximize $T_1$ given a constant $Q = \omega_s T_1$, ultimately settling on $\omega_s/2\pi = 4.134$ GHz. This was co-designed with the fluxonium so as to achieve bosonic mode threading. For the fluxonium-storage coupling $J_{fs}$, we performed numerical diagonalization simulations of the following Hamiltonian (similar to that in Ch. \ref{sec:4_3D_Experiment_Design_Theory}):
\begin{equation}
    \hat{H} =  \hat{H}_s + \hat{H}_{\rm int} + \hat{H}_{\rm fluxonium} =  \omega_s \hat{a}^\dagger \hat{a} + J_{fs} \hat{n}\hat{n}_a + \Big[4E_C \hat{n}^2 + \frac{1}{2}\hat{\varphi}^2 - E_J\cos(\hat{\varphi}-\varphi_{\rm ext})\Big],
\end{equation}
using which we calculated the dispersive shift $\chi = \omega_s^{|e\rangle} - \omega_s^{|g\rangle} = [E_{e,1} - E_{e, 0}] - [E_{g, 1} - E_{g, 0}]$ as well as the storage Kerr nonlinearities $K = (K_g + K_e)/2$ and $dK = (K_g - K_e)/2$ defined by $K_{g/e} = E_{g/e, 2} + E_{g/e, 0} - 2E_{g/e, 1}$. We then manually varied $\omega_s$ and $J_{fs}$ so as to achieve a low $K$ and $dK$ (on the order of Hz)\footnote{We have seen in simulations that the average Kerr $K$ is worse for GKP performance than differential Kerr $dK$. We can typically afford $dK$ to be slightly (as much as 5-10x) larger than $K$; ideally we have $K < 5$ Hz.} over the external flux range of interest $\Phi_{\rm ext}/\Phi_0 \in [0.42, 0.5]$, while also having a flux-tunable $\chi$ that crosses through zero and that is large enough away from this zero-crossing to perform ECD. We tried to target similar values for $\chi$, $K$, and $dK$ as Ref. \cite{sivak2023gkp-expt}, and ultimately chose the operating point $\Phi_{\rm ext} \simeq 0.43\Phi_0$ where $\chi/2\pi \simeq 50$ kHz, $K/2\pi \simeq 1$ Hz, and $dK/2\pi \simeq 10$ Hz, as shown in Fig. \ref{fig:5_2D_dispersive_metrics}(c). Meanwhile, the reset point at which the storage dispersive shift $\chi \to 0$ occurs at $\Phi_{\rm ext} \simeq 0.475\Phi_0$. 
\begin{figure}[h]
    \centering
    \includegraphics[width=\linewidth]{Figures/5/2D_dispersive_metrics.pdf}
    \caption{\textbf{(a, b)} Simulated fluxonium spectrum for 2D dispersive experiment showing transitions $\ket{g/e}\to\ket{n}$ and the associated charge matrix elements. The storage mode (teal) is threaded between the two sets of plasmon transitions. \textbf{(c)} Simulated storage dispersive shift $\chi$ (kHz), average Kerr $K$ (Hz) and differential Kerr $dK$ (Hz). We label the operating points where we perform reset and conditional displacements (CD) respectively.}
    \label{fig:5_2D_dispersive_metrics}
\end{figure}

\noindent \textbf{Readout and Purcell Filter:} We used a similar design for the readout resonator and Purcell filter as the RAF; both resonators were standard 50 $\Omega$ coplanar waveguide resonators with frequencies $\omega_r/2\pi = 6.125$ and $\omega_p/2\pi = 6.137$. We chose $g_{pr}$ to be greater than the detuning of the modes, so that the two are almost fully hybridized with normal mode frequencies of roughly $\omega_r - g_{pr}$ and $\omega_p + g_{pr}$ [to see this, diagonalize $\hat{H}_{pr} = \omega_r\hat{r}^\dagger \hat{r} + \omega_p\hat{p}^\dagger \hat{p} + g_{pr}(\hat{r}^\dagger\hat{p} + \hat{r}\hat{p}^\dagger)$]. The Purcell filter is strongly coupled to a transmission line with a coupling of $\kappa_p/2\pi \simeq 38.8$ MHz. By choosing $g_{pr} \lesssim \kappa_p$, this results in an effective readout coupling rate of $\kappa_r/2\pi \simeq 16$ MHz. The reason for choosing such a large value of $\kappa_r$ is to implement fast unconditional reset of the qubit. As shown in Fig. \ref{fig:5_SBS_Sideband_Reset}, our proposed approach to implement the reset is via direct fluxonium sideband cooling, as was recently demonstrated in Ref. \cite{najera2024high}. This is done by driving the $\ket{e0}\leftrightarrow\ket{g1}$ transition between the qubit and resonator away from the half-flux sweet spot; the strong loss on the resonator will then cause this to decay to $\ket{g0}$. In this manner, we can realize fast unconditional reset of the fluxonium, as is required for the SBS protocol.

\begin{figure}[h]
    \centering
 \includegraphics[width=\linewidth]{Figures/5/SBS_Sideband_Reset.pdf}
    \caption{SBS sequence consisting of 3 conditional displacements (teal), 4 qubit pulses (purple),  and unconditional qubit reset (lilac). The reset can be further decomposed into a number of dissipative swap operations based on fluxonium $\ket{e0}\leftrightarrow\ket{g1}$ sideband cooling.}
    \label{fig:5_SBS_Sideband_Reset}
\end{figure}

\clearpage
\subsection{Performance Estimates}

The first check we carried out when assessing the feasibility of a 2D dispersive design was to determine how quickly we can implement a round of SBS (i.e. one quadrature of QEC). We based this on preliminary simulations from our theory collaborators Jonathan Pelletier and Baptiste Royer that indicated\footnote{These simulations aren't yet published, but they show that the maximum storage photon number at which ECD starts to break in simulation is similar or even slightly higher for a fluxonium than for a transmon.} that a fluxonium qubit is not significantly different than a transmon from the perspective of carrying out ECD. As a result (cf. above), we designed our storage-fluxonium system to have a similar dispersive shift and Kerr nonlinearity as the storage-transmon system from Ref. \cite{sivak2023gkp-expt}, and assumed in what follows that we can use a similar photon number (approximately 100-140 storage photons) in ECD. 

\noindent The sequence for SBS is shown in Fig. \ref{fig:5_SBS_Sideband_Reset}: it consists of 4 conditional displacements (CDs), 3 qubit $\pi/2$ rotations, and qubit reset. We assume our CDs take the same time as Ref. \cite{sivak2023gkp-expt} and that our qubit pulses each take 32 ns; meanwhile for reset, we follow Ref. \cite{nordquantique2023gkp-expt} where the authors used $N_{\rm reset} = 2$ dissipative swaps. In our case, our readout has a linewidth of $\kappa_r / 2\pi \approx 16$ MHz, giving a $T_1 \simeq 9$ ns. From here, we estimate our worst case reset time to be $T_{\rm diss. swap} \simeq 132$ ns\footnote{This estimate is based on comparing to the parameters of Ref. \cite{nordquantique2023gkp-expt}; we hope it will be a worst-case value}. In total, the time $\delta t$ that we estimate it will take for an SBS round is:
\begin{align*}
\delta t = T_{\rm sBs}  &= 4T_{\rm pi} + (T_{\rm CD\,1} + T_{\rm CD\,2} + T_{\rm CD\,3}) + \big[N_{\text{reset}}\times T_{\text{diss. swap}}\big] \\ &= 4\times (32) + (470 + 676 + 230) + \Big[2 \times 132\Big] = 1768\, {\rm ns}
\end{align*}
We performed extensive SBS simulations using this value of $\delta t$, assuming different levels of single-photon loss $\kappa_{1s}$. We followed the method from Sec. \ref{sec:2_simulations_SBS} by modelling the sequence as an instantaneous QEC channel followed by a loss channel of length $\delta t$ (recall, this gives a lower bound on logical lifetime). For the QEC, we additionally optimized over the error correction parameters (i.e. code size $\Delta$ and small displacements $\epsilon_1, \epsilon_2$) to find the highest logical lifetime $T_L$ at each value of $T_{1s} = 1/\kappa_{1s}$. The results are shown in Fig. \ref{fig:2D_vs_3D_SBS_Comparison}; we plot the dimensionless quantity $T_L/\delta t$ (the number of rounds we can stabilize for) vs. $T_{1s}/\delta t$, the effective storage lifetime in units of the SBS cycle time. We repeat this process for the three cases: (i) a perfect/lossless control qubit (blue); (ii) a control qubit with $T_1 = 1.2$ ms (orange); and (iii) a control qubit with $T_1 = 300$ $\mu$s (green). For each value of $T_{1s}$ we also plot the lifetime of the oscillator $\{\ket{0}, \ket{1}\}$ Fock qubit (black), which is calculated as done in Ref. \cite{royer2020gkp} by $T_L^{\rm fock} = T_{1s}/2$. We see from these results that, at least in simulation, we are able to achieve break-even over the oscillator Fock encoding in all cases. 

\begin{figure}[t]
    \centering
    \includegraphics[width=0.8\linewidth]{Figures/5/2D_vs_3D_SBS_Comparison.png}
    \caption{Simulated plot of dimensionless maximum GKP logical lifetime $T_L/\delta t$ from SBS simulations vs. dimensionless storage lifetime $T_{1s}/\delta t$. Here $\delta t$ is the SBS cycle time. We optimized over GKP code parameters to find the maximum $T_L$ at each value of $T_{1s}$, and repeat this for the cases of a lossless qubit, a qubit with $T_1 = 1.2$ ms (e.g. a fluxonium), and a qubit with $T_1 = 300$ $\mu$s (e.g. a transmon). We find that all three cases outperform the bare oscillator Fock encoding here. The ranges in grey are overlaid on the plot assuming $\delta t = 1.7$ $\mu$s and $T_{1s} \in [45, 200]$ $\mu$s for the 2D dispersive experiment; $\delta t = 2.8$ $\mu$s and $T_{1s} \in [200, 700]$ $\mu$s for the 3D dispersive experiment; and finally $\delta t = 400$ ns and $T_{1s} \in [45, 200]$ $\mu$s for the 2D parametric experiment (RAF).}
    \label{fig:2D_vs_3D_SBS_Comparison}
\end{figure}

\noindent Of course, in practice, the logical lifetime will be reduced by many other experimental factors. But, we see from this that it is at least plausible to realize break-even error correction. Finally, since these curves depend only on the product $\kappa_{1s}\delta t$ (i.e. on $T_{1s}/\delta t$), we can use the x-axis to get a sense of the required storage lifetimes for each of our three experiments: the 3D dispersive, the 2D dispersive, and the RAF (2D parametric). We overlay the three expected performance ranges on the plot; what we see is that in the best case scenario, the performance of the 2D dispersive experiment should not be too far behind the ideal performance that we had originally hoped for in our 3D experiment. Additionally, by the same metric, we see that the RAF experiment has the potential to far outperform the other two approaches, and so we expect to be able to achieve state-of-the-art QEC gain here.

Overall, we find that both of our upcoming experiments represent promising pathways towards realizing robust and extensible GKP error correction in 2D. The expect to receive both the RAF and 2D dispersive designs shortly after this writing, and are excited to test these platforms in experiment.  



\printbibliography[heading=subbibliography, title = References]